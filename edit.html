<h2>Replace Element in Component</h2>
<h3>Replace Text</h3>
<input id="instanceValue" type="number" placeholder="No of instance" />
<input id="newText" placeholder="New text" />
<div>
  <input type="checkbox" id="imagecheck" />
  <label for="imagecheck">Image Check</label>
</div>
<h3>Replace Image</h3>
<div>
  <input type="file" id="file-input" accept="image/*" disabled />
</div>
<!-- <input id="imageName" placeholder="Image name to replace" /> -->
<!-- <input id="newImageUrl" placeholder="New image URL" /> -->
<button id="upload-button">Upload</button>

<script>
  const checkBox = document.getElementById("imagecheck");
  const fileInput = document.getElementById("file-input");

  const uploadButton = document.getElementById("upload-button");

  checkBox.addEventListener("change", function () {
    const selectedValue = checkBox.checked;

    console.log(selectedValue);

    if (selectedValue) {
      fileInput.disabled = false; // Enable the button if a value is selected
      uploadButton.disabled = true;

      if (fileInput.files.length > 0) {
        uploadButton.disabled = false; // Enable the upload button
      }
    } else {
      fileInput.disabled = true; // Disable the button if no value is selected
      uploadButton.disabled = false;
    }
    console.log(fileInput.files.length);
  });
  fileInput.addEventListener("change", function () {
    if (fileInput.files.length > 0) {
      // A file is selected

      uploadButton.disabled = false; // Enable the upload button
      //     uploadButton.disabled = !fileInput.files.length;
    } else {
      // No file is selected
      uploadButton.disabled = true; // Disable the upload button
    }
  });

  uploadButton.onclick = () => {
    const instanceValue = document.getElementById("instanceValue").value;
    const newText = document.getElementById("newText").value;
    console.log(newText);
    console.log("html");

    const file = fileInput.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function (event) {
        const arrayBuffer = event.target.result;
        console.log(arrayBuffer);
        parent.postMessage(
          {
            pluginMessage: {
              type: "replace-all",
              imageBytes: new Uint8Array(arrayBuffer),
              newText,
              instanceValue,
            },
          },
          "*"
        );
      };
      reader.readAsArrayBuffer(file);
    } else {
       parent.postMessage(
          {
            pluginMessage: {
              type: "replace-all",
              newText,
              instanceValue,
            },
          },
          "*"
        );
    }
    // const imageName = document.getElementById("imageName").value;
    // const newImageUrl = document.getElementById("newImageUrl").value;
    // parent.postMessage(
    //   { pluginMessage: { type: "replace-image", imageName, newImageUrl } },
    //   "*"
    // );
  };

  //   document.getElementById("upload-button").onclick = () => {
  //     const imageName = document.getElementById("imageName").value;
  //     const newImageUrl = document.getElementById("newImageUrl").value;
  //     parent.postMessage(
  //       { pluginMessage: { type: "replace-image", imageName, newImageUrl } },
  //       "*"
  //     );
  //   };
</script>
