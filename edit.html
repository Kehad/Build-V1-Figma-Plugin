<h2>Replace Element in Component</h2>
<h3>Replace Text</h3>
<input id="instanceValue" type="number" placeholder="No of instance" />
<input id="newText" placeholder="New text" />
<button id="replaceBtn">Replace</button>
<input type="checkbox" id="imagecheck" />
<label for="imagecheck">Image Check</label>
<h3>Replace Image</h3>
<input type="file" id="file-input" accept="image/*" disabled />
<!-- <input id="imageName" placeholder="Image name to replace" /> -->
<!-- <input id="newImageUrl" placeholder="New image URL" /> -->
<button id="upload-button">Upload</button>

<script>
  const checkBox = document.getElementById("imagecheck");
  const fileInput = document.getElementById("file-input");
  const replaceEl = document.getElementById("replaceBtn");
  const uploadButton = document.getElementById("upload-button");

  checkBox.addEventListener("change", function () {
    const selectedValue = checkBox.checked;
    console.log("imge changed");
    console.log(selectedValue);

    if (selectedValue) {
      console.log("It is selected");
      fileInput.disabled = false; // Enable the button if a value is selected
      uploadButton.disabled = true;

      //     fileInput.addEventListener("change", function () {
      //   replaceEl.disabled = !fileInput.files.length;
      // });
      if (fileInput.files.length > 0) {
        // A file is selected
        console.log('file present')
        uploadButton.disabled = false; // Enable the upload button
      }
    } else {
      console.log("Unselected");
      fileInput.disabled = true; // Disable the button if no value is selected
      uploadButton.disabled = false;
    }
    console.log(fileInput.files.length);

  });
  fileInput.addEventListener("change", function () {
    if (fileInput.files.length > 0) {
      // A file is selected
      console.log('file present')
      uploadButton.disabled = false; // Enable the upload button
    } else {
      // No file is selected
      console.log('No file selected')
      uploadButton.disabled = true; // Disable the upload button
    }
  });

//   replaceEl.onclick = () => {
  uploadButton.onclick = () => {
    const instanceValue = document.getElementById("instanceValue").value;
    const newText = document.getElementById("newText").value;
    console.log(newText);
    console.log("html");
    parent.postMessage(
      { pluginMessage: { type: "replace-text", newText, instanceValue } },
      "*"
    );
    // const imageName = document.getElementById("imageName").value;
    // const newImageUrl = document.getElementById("newImageUrl").value;
    // parent.postMessage(
    //   { pluginMessage: { type: "replace-image", imageName, newImageUrl } },
    //   "*"
    // );
  };

//   document.getElementById("upload-button").onclick = () => {
//     const imageName = document.getElementById("imageName").value;
//     const newImageUrl = document.getElementById("newImageUrl").value;
//     parent.postMessage(
//       { pluginMessage: { type: "replace-image", imageName, newImageUrl } },
//       "*"
//     );
//   };

  //   fileInput.addEventListener("change", function () {
  //     uploadButton.disabled = !fileInput.files.length;
  //   });

  uploadButton.addEventListener("click", function () {
    const file = fileInput.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function (event) {
        const arrayBuffer = event.target.result;
        parent.postMessage(
          {
            pluginMessage: {
              type: "upload-image",
              imageBytes: new Uint8Array(arrayBuffer),
            },
          },
          "*"
        );
      };
      reader.readAsArrayBuffer(file);
    }
  });
</script>
 